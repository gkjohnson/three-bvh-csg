import{B as L,G as R,j as W,W as T,S as U,D as z,A,P as H,O as k,a as D,M as _,c as P,k as i,C as j}from"./TriangleSplitter-ByAGyBL2.js";import{g as I}from"./lil-gui.module.min-BH_YJbPT.js";import{T as F}from"./TransformControls-CbZU_T1b.js";import{B as K,A as x,E as N,S as y}from"./Evaluator-Coej1Gnr.js";import{G as V}from"./GridMaterial-CluEDJjd.js";class r extends K{constructor(...t){super(...t),this.isOperation=!0,this.operation=x,this._cachedGeometry=new L,this._cachedMaterials=null,this._previousOperation=null}markUpdated(){super.markUpdated(),this._previousOperation=this.operation}isDirty(){return this.operation!==this._previousOperation||super.isDirty()}insertBefore(t){const n=this.parent,o=n.children.indexOf(this);n.children.splice(o,0,t)}insertAfter(t){const n=this.parent,o=n.children.indexOf(this);n.children.splice(o+1,0,t)}}class C extends R{constructor(){super(),this.isOperationGroup=!0,this._previousMatrix=new W}markUpdated(){this._previousMatrix.copy(this.matrix)}isDirty(){const{matrix:t,_previousMatrix:n}=this,o=t.elements,m=n.elements;for(let d=0;d<16;d++)if(o[d]!==m[d])return!0;return!1}}const a={snap:!0,wireframe:!1,displayControls:!0,transparentBrushes:!0,display:"OVERLAY"};let c,w,u,g,S,G,s,E,M,O,l,h,e,f,b;Y();async function Y(){S=document.getElementById("output"),c=new T({antialias:!0}),c.setPixelRatio(window.devicePixelRatio),c.setSize(window.innerWidth,window.innerHeight),c.setClearColor(1118481,1),document.body.appendChild(c.domElement),u=new U,M=new z(16777215,3.5),M.position.set(-1,2,3),u.add(M,M.target),u.add(new A(11583173,.35)),w=new H(75,window.innerWidth/window.innerHeight,.1,50),w.position.set(3,2,4).multiplyScalar(2),w.far=100,w.updateProjectionMatrix(),G=new k(w,c.domElement),s=new F(w,c.domElement),s.setSize(.75),s.addEventListener("dragging-changed",t=>{G.enabled=!t.value}),s.addEventListener("objectChange",t=>{if(a.snap){const n=s.object;n.position.x=Math.floor(n.position.x*10)*.1,n.position.y=Math.floor(n.position.y*10)*.1,n.position.z=Math.floor(n.position.z*10)*.1}}),E=s.getHelper(),u.add(E),O=new N,O.attributes=["position","normal"],O.useGroups=!1,e=new V,e.side=D,e.polygonOffset=!0,e.polygonOffsetFactor=2,e.polygonOffsetUnits=1,e.opacity=.15,e.transparent=!0,e.depthWrite=!1,e.color.set(16761856),f=e.clone(),f.opacity=1,f.transparent=!1,f.depthWrite=!0,f.polygonOffsetFactor=1,f.polygonOffsetUnits=1,f.color.set(16777215),b=new _(void 0,new P({color:0,wireframe:!0,opacity:.25,transparent:!0})),b.material.color.set(16761856).multiplyScalar(.1),u.add(b),h=new r(new i(10,5,5),e),u.add(h);{const t=new r(new i(9,4.5,4),e);t.operation=y,h.add(t)}{const t=new r(new j(.5,.5,1,20),e);t.operation=y,t.rotateX(Math.PI/2),t.position.y=.25;const n=new r(new i(1,2.5,1),e);n.operation=y,n.position.y=-1;const o=new C;o.position.z=2.2,o.add(t,n),h.add(o),s.attach(o)}{const t=new r(new i(2,1.75,2),e);t.operation=y;const n=new r(new i(2,1.75,.2),e);n.operation=x;const o=new r(new i(1.9,1.65,2),e);o.operation=y;const m=new r(new i(2,.1,.1),e);m.operation=x;const d=new r(new i(.1,2,.1),e);d.operation=x;const p=new C;p.add(t,n,o,m,d),p.position.x=-3,p.position.z=2.2,h.add(p)}{const t=new r(new i(2,1.75,2),e);t.operation=y;const n=new r(new i(2,1.75,.2),e);n.operation=x;const o=new r(new i(1.9,1.65,2),e);o.operation=y;const m=new r(new i(2,.1,.1),e);m.operation=x;const d=new r(new i(.1,2,.1),e);d.operation=x;const p=new C;p.add(t,n,o,m,d),p.position.x=3,p.position.z=2.2,h.add(p)}g=new I,g.add(a,"wireframe"),g.add(a,"snap"),g.add(a,"displayControls"),g.add(a,"transparentBrushes"),g.add(a,"display",["OVERLAY","BRUSHES","RESULT"]),window.addEventListener("resize",function(){w.aspect=window.innerWidth/window.innerHeight,w.updateProjectionMatrix(),c.setSize(window.innerWidth,window.innerHeight)},!1),window.addEventListener("keydown",function(t){switch(t.code){case"KeyW":s.setMode("translate");break;case"KeyE":s.setMode("rotate");break;case"KeyR":s.setMode("scale");break}}),B()}function B(){requestAnimationFrame(B);const v=window.performance.now();a.transparentBrushes?(e.depthWrite=!1,e.transparent=!0,e.opacity=.15):(e.depthWrite=!0,e.transparent=!1,e.opacity=1),l&&(l.geometry.dispose(),l.parent.remove(l)),l=O.evaluateHierarchy(h),l.material=f,u.add(l),b.geometry=l.geometry,b.visible=a.wireframe;const t=window.performance.now()-v;S.innerText=`${t.toFixed(3)}ms`,s.enabled=a.displayControls,E.visible=a.displayControls,l.visible=a.display!=="BRUSHES",h.visible=a.display!=="RESULT",c.render(u,w)}
